<!-- estudiante-notificaciones.html - VERSIÃ“N CORREGIDA -->
<div class="notificaciones-container">
  <div class="notificaciones-header">
    <h3>ğŸ“¢ Mis Notificaciones</h3>
    <div class="notificaciones-actions">
      <button class="btn-refresh" (click)="actualizar()" [disabled]="cargando">
        ğŸ”„ {{ cargando ? 'Cargando...' : 'Actualizar' }}
      </button>
      <button class="btn-clear" (click)="limpiarTodas()" [disabled]="total === 0">
        ğŸ—‘ï¸ Limpiar todas
      </button>
    </div>
  </div>

  <!-- Estado de carga/error -->
  <div *ngIf="cargando" class="loading-state">
    <div class="spinner"></div>
    <p>Cargando notificaciones...</p>
  </div>

  <div *ngIf="error && !cargando" class="error-state">
    <p>âŒ {{ error }}</p>
    <button (click)="actualizar()">Reintentar</button>
  </div>

  <!-- Lista de notificaciones -->
  <div *ngIf="!cargando && !error" class="notificaciones-list">
    <div *ngIf="total === 0" class="empty-state">
      <p>ğŸ‰ No tienes notificaciones nuevas</p>
      <small>Todas las notificaciones importantes aparecerÃ¡n aquÃ­</small>
    </div>

    <div *ngFor="let notif of notificaciones; trackBy: trackById" 
    [ngClass]="getNotificacionClasses(notif.tipo)"
         class="notificacion-item"
         [class.unread]="true"
         [class.type-calificacion]="notif.tipo === 'calificacion'"
         [class.type-entrega_nueva]="notif.tipo === 'entrega_nueva' || notif.tipo === 'entrega'"
         [class.type-actividad]="notif.tipo === 'actividad'"
         [class.type-sistema]="notif.tipo === 'sistema' || !notif.tipo"
         [class.type-mensaje]="notif.tipo === 'mensaje'"
         [class.type-recordatorio]="notif.tipo === 'recordatorio'">
      
      <div class="notificacion-icon">
        {{ getIconoTipo(notif.tipo) }}
      </div>
      
      <div class="notificacion-content">
        <div class="notificacion-header">
          <strong>{{ notif.mensaje }}</strong>
          <small class="notificacion-time">{{ formatearFecha(notif.fecha_envio) }}</small>
        </div>
        
        <div class="notificacion-details">
          <span *ngIf="notif.docente" class="badge docente">
            ğŸ“š {{ notif.docente }}
          </span>
          <span *ngIf="notif.actividad" class="badge actividad">
            ğŸ“ {{ notif.actividad }}
          </span>
          <span class="badge tipo" 
                [class.tipo-calificacion]="notif.tipo === 'calificacion'"
                [class.tipo-entrega]="notif.tipo === 'entrega_nueva' || notif.tipo === 'entrega'"
                [class.tipo-actividad]="notif.tipo === 'actividad'"
                [class.tipo-sistema]="notif.tipo === 'sistema' || !notif.tipo">
            {{ getTipoTexto(notif.tipo) }}
          </span>
        </div>
      </div>

      <button class="btn-mark-read" (click)="marcarComoLeida(notif.id_notificacion)" 
              title="Marcar como leÃ­da">
        âœ“
      </button>
    </div>
  </div>

  <div class="notificaciones-footer" *ngIf="total > 0">
    <p><small>Mostrando {{ notificaciones.length }} de {{ total }} notificaciones</small></p>
  </div>
</div>